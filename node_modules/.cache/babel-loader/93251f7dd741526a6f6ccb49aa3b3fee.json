{"ast":null,"code":"import _toConsumableArray from\"C:/Win11/Programming/Other/ticket-to-ride-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import*as actions from\"./actions\";import io from\"socket.io-client\";var socket=null;export var socketMiddleware=function socketMiddleware(){return function(next){return function(action){var _socket;switch(action.type){case\"WS_CONNECT\":if(socket!==null){socket.close();}socket=io(action.host,{transports:[\"websocket\",\"polling\",\"flashsocket\"]});break;case actions.WS_SUBSCRIBE:handleSubscribeToChannel(action.payload);break;case actions.WS_UNSUBSCRIBE:handleUnsubscribeFromChannel(action.payload);break;case actions.WS_SEND_MESSAGE:(_socket=socket).emit.apply(_socket,[action.channel].concat(_toConsumableArray(action.datas),[action.ack]));break;case\"WS_DISCONNECT\":if(socket!==null){socket.close();}socket=null;console.log(\"websocket closed\");break;default:return next(action);}};};};export function currentSocketId(){return socket?socket.id:null;}function handleSubscribeToChannel(_ref){var channel=_ref.channel,callback=_ref.callback;socket.on(channel,function(data){return callback(data);});}function handleUnsubscribeFromChannel(channel){socket.removeAllListeners(channel);}","map":{"version":3,"names":["actions","io","socket","socketMiddleware","next","action","type","close","host","transports","WS_SUBSCRIBE","handleSubscribeToChannel","payload","WS_UNSUBSCRIBE","handleUnsubscribeFromChannel","WS_SEND_MESSAGE","emit","channel","datas","ack","console","log","currentSocketId","id","callback","on","data","removeAllListeners"],"sources":["C:/Win11/Programming/Other/ticket-to-ride-app/src/state/socket/reducer.js"],"sourcesContent":["import * as actions from \"./actions\";\r\nimport io from \"socket.io-client\";\r\n\r\nlet socket = null;\r\n\r\nexport const socketMiddleware = () => (next) => (action) => {\r\n  switch (action.type) {\r\n    case \"WS_CONNECT\":\r\n      if (socket !== null) {\r\n        socket.close();\r\n      }\r\n\r\n      socket = io(action.host, {\r\n        transports: [\"websocket\", \"polling\", \"flashsocket\"],\r\n      });\r\n      break;\r\n    case actions.WS_SUBSCRIBE:\r\n      handleSubscribeToChannel(action.payload);\r\n      break;\r\n    case actions.WS_UNSUBSCRIBE:\r\n      handleUnsubscribeFromChannel(action.payload);\r\n      break;\r\n    case actions.WS_SEND_MESSAGE:\r\n      socket.emit(action.channel, ...action.datas, action.ack);\r\n      break;\r\n    case \"WS_DISCONNECT\":\r\n      if (socket !== null) {\r\n        socket.close();\r\n      }\r\n      socket = null;\r\n      console.log(\"websocket closed\");\r\n      break;\r\n    default:\r\n      return next(action);\r\n  }\r\n};\r\n\r\nexport function currentSocketId() {\r\n  return socket ? socket.id : null;\r\n}\r\n\r\nfunction handleSubscribeToChannel({ channel, callback }) {\r\n  socket.on(channel, (data) => callback(data));\r\n}\r\n\r\nfunction handleUnsubscribeFromChannel(channel) {\r\n  socket.removeAllListeners(channel);\r\n}\r\n"],"mappings":"2IAAA,MAAO,GAAKA,QAAO,KAAM,WAAW,CACpC,MAAOC,GAAE,KAAM,kBAAkB,CAEjC,GAAIC,OAAM,CAAG,IAAI,CAEjB,MAAO,IAAMC,iBAAgB,CAAG,QAAnBA,iBAAgB,SAAS,UAACC,IAAI,QAAK,UAACC,MAAM,CAAK,aAC1D,OAAQA,MAAM,CAACC,IAAI,EACjB,IAAK,YAAY,CACf,GAAIJ,MAAM,GAAK,IAAI,CAAE,CACnBA,MAAM,CAACK,KAAK,EAAE,CAChB,CAEAL,MAAM,CAAGD,EAAE,CAACI,MAAM,CAACG,IAAI,CAAE,CACvBC,UAAU,CAAE,CAAC,WAAW,CAAE,SAAS,CAAE,aAAa,CACpD,CAAC,CAAC,CACF,MACF,IAAKT,QAAO,CAACU,YAAY,CACvBC,wBAAwB,CAACN,MAAM,CAACO,OAAO,CAAC,CACxC,MACF,IAAKZ,QAAO,CAACa,cAAc,CACzBC,4BAA4B,CAACT,MAAM,CAACO,OAAO,CAAC,CAC5C,MACF,IAAKZ,QAAO,CAACe,eAAe,CAC1B,SAAAb,MAAM,EAACc,IAAI,gBAACX,MAAM,CAACY,OAAO,4BAAKZ,MAAM,CAACa,KAAK,GAAEb,MAAM,CAACc,GAAG,GAAC,CACxD,MACF,IAAK,eAAe,CAClB,GAAIjB,MAAM,GAAK,IAAI,CAAE,CACnBA,MAAM,CAACK,KAAK,EAAE,CAChB,CACAL,MAAM,CAAG,IAAI,CACbkB,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC,CAC/B,MACF,QACE,MAAOjB,KAAI,CAACC,MAAM,CAAC,CAAC,CAE1B,CAAC,KAED,MAAO,SAASiB,gBAAe,EAAG,CAChC,MAAOpB,OAAM,CAAGA,MAAM,CAACqB,EAAE,CAAG,IAAI,CAClC,CAEA,QAASZ,yBAAwB,MAAwB,IAArBM,QAAO,MAAPA,OAAO,CAAEO,QAAQ,MAARA,QAAQ,CACnDtB,MAAM,CAACuB,EAAE,CAACR,OAAO,CAAE,SAACS,IAAI,QAAKF,SAAQ,CAACE,IAAI,CAAC,GAAC,CAC9C,CAEA,QAASZ,6BAA4B,CAACG,OAAO,CAAE,CAC7Cf,MAAM,CAACyB,kBAAkB,CAACV,OAAO,CAAC,CACpC"},"metadata":{},"sourceType":"module"}