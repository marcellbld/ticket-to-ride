{"ast":null,"code":"import _regeneratorRuntime from\"C:/Win11/Programming/Other/ticket-to-ride-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Win11/Programming/Other/ticket-to-ride-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Win11/Programming/Other/ticket-to-ride-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import{ClientMessages}from\"../../api/socket\";import{wsSendMessage}from\"../socket/actions\";export var SET_ROOM=\"CREATE_ROOM\";export var JOIN_ROOM=\"JOIN_ROOM\";export function setRoom(roomId,roomSize){var players=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];return{type:SET_ROOM,payload:{roomId:roomId,roomSize:roomSize,players:players}};}export function joinRoom(playerId,playerName,roomId,callback){return function(dispatch){var ack=function ack(resp){if(resp.status===\"ok\"){dispatch(wsSendMessage(ClientMessages.GET_STATE,[roomId],function(resp){var gameRoom=JSON.parse(resp.state);gameRoom.players=[].concat(_toConsumableArray(gameRoom.players),[{id:playerId,name:playerName}]);dispatch(wsSendMessage(ClientMessages.SYNC_STATE,[gameRoom.roomId,gameRoom,false],function(){}));}));}callback(resp);};dispatch(wsSendMessage(ClientMessages.JOIN_ROOM,[roomId],ack));};}export function createRoom(playerId,playerName,roomSize,callback){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch,getState){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(wsSendMessage(ClientMessages.CREATE_ROOM,[roomSize],function(resp){dispatch(setRoom(resp.roomId,roomSize,[{id:playerId,name:playerName}]));var lobbyRoom=getState().lobby;dispatch(wsSendMessage(ClientMessages.SYNC_STATE,[lobbyRoom.roomId,lobbyRoom,false],function(){}));callback(resp);}));case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();}","map":{"version":3,"names":["ClientMessages","wsSendMessage","SET_ROOM","JOIN_ROOM","setRoom","roomId","roomSize","players","type","payload","joinRoom","playerId","playerName","callback","dispatch","ack","resp","status","GET_STATE","gameRoom","JSON","parse","state","id","name","SYNC_STATE","createRoom","getState","CREATE_ROOM","lobbyRoom","lobby"],"sources":["C:/Win11/Programming/Other/ticket-to-ride-app/src/state/lobby/actions.js"],"sourcesContent":["import { ClientMessages } from \"../../api/socket\";\r\nimport { wsSendMessage } from \"../socket/actions\";\r\n\r\nexport const SET_ROOM = \"CREATE_ROOM\";\r\nexport const JOIN_ROOM = \"JOIN_ROOM\";\r\n\r\nexport function setRoom(roomId, roomSize, players = []) {\r\n  return {\r\n    type: SET_ROOM,\r\n    payload: { roomId, roomSize, players },\r\n  };\r\n}\r\n\r\nexport function joinRoom(playerId, playerName, roomId, callback) {\r\n  return (dispatch) => {\r\n    const ack = function (resp) {\r\n      if (resp.status === \"ok\") {\r\n        dispatch(\r\n          wsSendMessage(ClientMessages.GET_STATE, [roomId], (resp) => {\r\n            const gameRoom = JSON.parse(resp.state);\r\n            gameRoom.players = [...gameRoom.players, {id: playerId, name: playerName}];\r\n            dispatch(\r\n              wsSendMessage(\r\n                ClientMessages.SYNC_STATE,\r\n                [gameRoom.roomId, gameRoom, false],\r\n                function () {}\r\n              )\r\n            );\r\n          })\r\n        );\r\n      }\r\n      callback(resp);\r\n    };\r\n    dispatch(wsSendMessage(ClientMessages.JOIN_ROOM, [roomId], ack));\r\n  };\r\n}\r\n\r\nexport function createRoom(playerId, playerName, roomSize, callback) {\r\n  return async (dispatch, getState) => {\r\n    dispatch(\r\n      wsSendMessage(ClientMessages.CREATE_ROOM, [roomSize], function (resp) {\r\n        dispatch(setRoom(resp.roomId, roomSize, [{id: playerId, name: playerName}]));\r\n        const lobbyRoom = getState().lobby;\r\n\r\n        dispatch(\r\n          wsSendMessage(\r\n            ClientMessages.SYNC_STATE,\r\n            [lobbyRoom.roomId, lobbyRoom, false],\r\n            function () {}\r\n          )\r\n        );\r\n\r\n        callback(resp);\r\n      })\r\n    );\r\n  };\r\n}\r\n"],"mappings":"iaAAA,OAASA,cAAc,KAAQ,kBAAkB,CACjD,OAASC,aAAa,KAAQ,mBAAmB,CAEjD,MAAO,IAAMC,SAAQ,CAAG,aAAa,CACrC,MAAO,IAAMC,UAAS,CAAG,WAAW,CAEpC,MAAO,SAASC,QAAO,CAACC,MAAM,CAAEC,QAAQ,CAAgB,IAAdC,QAAO,2DAAG,EAAE,CACpD,MAAO,CACLC,IAAI,CAAEN,QAAQ,CACdO,OAAO,CAAE,CAAEJ,MAAM,CAANA,MAAM,CAAEC,QAAQ,CAARA,QAAQ,CAAEC,OAAO,CAAPA,OAAQ,CACvC,CAAC,CACH,CAEA,MAAO,SAASG,SAAQ,CAACC,QAAQ,CAAEC,UAAU,CAAEP,MAAM,CAAEQ,QAAQ,CAAE,CAC/D,MAAO,UAACC,QAAQ,CAAK,CACnB,GAAMC,IAAG,CAAG,QAANA,IAAG,CAAaC,IAAI,CAAE,CAC1B,GAAIA,IAAI,CAACC,MAAM,GAAK,IAAI,CAAE,CACxBH,QAAQ,CACNb,aAAa,CAACD,cAAc,CAACkB,SAAS,CAAE,CAACb,MAAM,CAAC,CAAE,SAACW,IAAI,CAAK,CAC1D,GAAMG,SAAQ,CAAGC,IAAI,CAACC,KAAK,CAACL,IAAI,CAACM,KAAK,CAAC,CACvCH,QAAQ,CAACZ,OAAO,8BAAOY,QAAQ,CAACZ,OAAO,GAAE,CAACgB,EAAE,CAAEZ,QAAQ,CAAEa,IAAI,CAAEZ,UAAU,CAAC,EAAC,CAC1EE,QAAQ,CACNb,aAAa,CACXD,cAAc,CAACyB,UAAU,CACzB,CAACN,QAAQ,CAACd,MAAM,CAAEc,QAAQ,CAAE,KAAK,CAAC,CAClC,UAAY,CAAC,CAAC,CACf,CACF,CACH,CAAC,CAAC,CACH,CACH,CACAN,QAAQ,CAACG,IAAI,CAAC,CAChB,CAAC,CACDF,QAAQ,CAACb,aAAa,CAACD,cAAc,CAACG,SAAS,CAAE,CAACE,MAAM,CAAC,CAAEU,GAAG,CAAC,CAAC,CAClE,CAAC,CACH,CAEA,MAAO,SAASW,WAAU,CAACf,QAAQ,CAAEC,UAAU,CAAEN,QAAQ,CAAEO,QAAQ,CAAE,CACnE,iGAAO,iBAAOC,QAAQ,CAAEa,QAAQ,oHAC9Bb,QAAQ,CACNb,aAAa,CAACD,cAAc,CAAC4B,WAAW,CAAE,CAACtB,QAAQ,CAAC,CAAE,SAAUU,IAAI,CAAE,CACpEF,QAAQ,CAACV,OAAO,CAACY,IAAI,CAACX,MAAM,CAAEC,QAAQ,CAAE,CAAC,CAACiB,EAAE,CAAEZ,QAAQ,CAAEa,IAAI,CAAEZ,UAAU,CAAC,CAAC,CAAC,CAAC,CAC5E,GAAMiB,UAAS,CAAGF,QAAQ,EAAE,CAACG,KAAK,CAElChB,QAAQ,CACNb,aAAa,CACXD,cAAc,CAACyB,UAAU,CACzB,CAACI,SAAS,CAACxB,MAAM,CAAEwB,SAAS,CAAE,KAAK,CAAC,CACpC,UAAY,CAAC,CAAC,CACf,CACF,CAEDhB,QAAQ,CAACG,IAAI,CAAC,CAChB,CAAC,CAAC,CACH,CAAC,sDACH,mEACH"},"metadata":{},"sourceType":"module"}