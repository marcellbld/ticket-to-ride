{"ast":null,"code":"import { ClientMessages, GameActionTypes } from \"../../api/socket\";\nimport { GameStates } from \"../../domain/game\";\nimport { nextPlayerTurn } from \"../players/actions\";\nimport { wsSendMessage } from \"../socket/actions\";\nexport const NEXT_TURN = \"NEXT_TURN\";\nexport const SET_GAME = \"SET_GAME\";\nexport const SET_GAME_STATE = \"SET_GAME_STATE\";\nexport const SET_END_TURN = \"SET_END_TURN\";\nfunction setState(gameState) {\n  return {\n    type: SET_GAME_STATE,\n    payload: gameState\n  };\n}\nexport function setGame(game) {\n  return {\n    type: SET_GAME,\n    payload: game\n  };\n}\nfunction setEndGameTurn(endTurn) {\n  return {\n    type: SET_END_TURN,\n    payload: endTurn\n  };\n}\nfunction nextTurn() {\n  return {\n    type: \"NEXT_TURN\"\n  };\n}\nexport function setEndTurn(endTurn) {\n  let broadcast = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return (dispatch, getState) => {\n    dispatch(setEndGameTurn(endTurn));\n    if (broadcast) {\n      dispatch(wsSendMessage(ClientMessages.SYNC_ACTION, [getState().game.id, {\n        type: GameActionTypes.END_TURN,\n        payload: endTurn\n      }, false], function () {}));\n    }\n  };\n}\nexport function nextGameTurn() {\n  return (dispatch, getState) => {\n    dispatch(nextTurn());\n    dispatch(nextPlayerTurn(getState().game.currentPlayerId));\n    const endTurn = getState().game.endTurn;\n    const currentPlayer = getState().players.find(player => player.id === getState().game.currentPlayerId);\n    if (endTurn > -1 && currentPlayer.round >= endTurn) {\n      dispatch(setGameState(GameStates.END_GAME));\n    }\n  };\n}\nexport function setGameState(gameState) {\n  return (dispatch, getState) => {\n    dispatch(setState(gameState));\n    if (gameState === GameStates.DRAW_CARD2) {\n      dispatch(wsSendMessage(ClientMessages.SYNC_ACTION, [getState().game.id, {\n        type: GameActionTypes.NEXT_TURN\n      }, false], function () {}));\n    }\n  };\n}","map":{"version":3,"names":["ClientMessages","GameActionTypes","GameStates","nextPlayerTurn","wsSendMessage","NEXT_TURN","SET_GAME","SET_GAME_STATE","SET_END_TURN","setState","gameState","type","payload","setGame","game","setEndGameTurn","endTurn","nextTurn","setEndTurn","broadcast","dispatch","getState","SYNC_ACTION","id","END_TURN","nextGameTurn","currentPlayerId","currentPlayer","players","find","player","round","setGameState","END_GAME","DRAW_CARD2"],"sources":["C:/Win11/Programming/Other/ticket-to-ride-app/src/state/game/actions.js"],"sourcesContent":["import { ClientMessages, GameActionTypes } from \"../../api/socket\";\r\nimport { GameStates } from \"../../domain/game\";\r\nimport { nextPlayerTurn } from \"../players/actions\";\r\nimport { wsSendMessage } from \"../socket/actions\";\r\n\r\nexport const NEXT_TURN = \"NEXT_TURN\";\r\nexport const SET_GAME = \"SET_GAME\";\r\nexport const SET_GAME_STATE = \"SET_GAME_STATE\";\r\nexport const SET_END_TURN = \"SET_END_TURN\";\r\n\r\nfunction setState(gameState) {\r\n  return {\r\n    type: SET_GAME_STATE,\r\n    payload: gameState,\r\n  };\r\n}\r\n\r\nexport function setGame(game) {\r\n  return {\r\n    type: SET_GAME,\r\n    payload: game,\r\n  };\r\n}\r\n\r\nfunction setEndGameTurn(endTurn) {\r\n  return {\r\n    type: SET_END_TURN,\r\n    payload: endTurn,\r\n  };\r\n}\r\n\r\nfunction nextTurn() {\r\n  return {\r\n    type: \"NEXT_TURN\",\r\n  };\r\n}\r\n\r\nexport function setEndTurn(endTurn, broadcast = false) {\r\n  return (dispatch, getState) => {\r\n    dispatch(setEndGameTurn(endTurn));\r\n    if (broadcast) {\r\n      dispatch(\r\n        wsSendMessage(\r\n          ClientMessages.SYNC_ACTION,\r\n          [\r\n            getState().game.id,\r\n            { type: GameActionTypes.END_TURN, payload: endTurn },\r\n            false,\r\n          ],\r\n          function () {}\r\n        )\r\n      );\r\n    }\r\n  };\r\n}\r\n\r\nexport function nextGameTurn() {\r\n  return (dispatch, getState) => {\r\n    dispatch(nextTurn());\r\n    dispatch(nextPlayerTurn(getState().game.currentPlayerId));\r\n\r\n    const endTurn = getState().game.endTurn;\r\n    const currentPlayer = getState().players.find(\r\n      (player) => player.id === getState().game.currentPlayerId\r\n    );\r\n\r\n    if (endTurn > -1 && currentPlayer.round >= endTurn) {\r\n      dispatch(setGameState(GameStates.END_GAME));\r\n    }\r\n  };\r\n}\r\n\r\nexport function setGameState(gameState) {\r\n  return (dispatch, getState) => {\r\n    dispatch(setState(gameState));\r\n\r\n    if (gameState === GameStates.DRAW_CARD2) {\r\n      dispatch(\r\n        wsSendMessage(\r\n          ClientMessages.SYNC_ACTION,\r\n          [getState().game.id, { type: GameActionTypes.NEXT_TURN }, false],\r\n          function () {}\r\n        )\r\n      );\r\n    }\r\n  };\r\n}\r\n"],"mappings":"AAAA,SAASA,cAAc,EAAEC,eAAe,QAAQ,kBAAkB;AAClE,SAASC,UAAU,QAAQ,mBAAmB;AAC9C,SAASC,cAAc,QAAQ,oBAAoB;AACnD,SAASC,aAAa,QAAQ,mBAAmB;AAEjD,OAAO,MAAMC,SAAS,GAAG,WAAW;AACpC,OAAO,MAAMC,QAAQ,GAAG,UAAU;AAClC,OAAO,MAAMC,cAAc,GAAG,gBAAgB;AAC9C,OAAO,MAAMC,YAAY,GAAG,cAAc;AAE1C,SAASC,QAAQ,CAACC,SAAS,EAAE;EAC3B,OAAO;IACLC,IAAI,EAAEJ,cAAc;IACpBK,OAAO,EAAEF;EACX,CAAC;AACH;AAEA,OAAO,SAASG,OAAO,CAACC,IAAI,EAAE;EAC5B,OAAO;IACLH,IAAI,EAAEL,QAAQ;IACdM,OAAO,EAAEE;EACX,CAAC;AACH;AAEA,SAASC,cAAc,CAACC,OAAO,EAAE;EAC/B,OAAO;IACLL,IAAI,EAAEH,YAAY;IAClBI,OAAO,EAAEI;EACX,CAAC;AACH;AAEA,SAASC,QAAQ,GAAG;EAClB,OAAO;IACLN,IAAI,EAAE;EACR,CAAC;AACH;AAEA,OAAO,SAASO,UAAU,CAACF,OAAO,EAAqB;EAAA,IAAnBG,SAAS,uEAAG,KAAK;EACnD,OAAO,CAACC,QAAQ,EAAEC,QAAQ,KAAK;IAC7BD,QAAQ,CAACL,cAAc,CAACC,OAAO,CAAC,CAAC;IACjC,IAAIG,SAAS,EAAE;MACbC,QAAQ,CACNhB,aAAa,CACXJ,cAAc,CAACsB,WAAW,EAC1B,CACED,QAAQ,EAAE,CAACP,IAAI,CAACS,EAAE,EAClB;QAAEZ,IAAI,EAAEV,eAAe,CAACuB,QAAQ;QAAEZ,OAAO,EAAEI;MAAQ,CAAC,EACpD,KAAK,CACN,EACD,YAAY,CAAC,CAAC,CACf,CACF;IACH;EACF,CAAC;AACH;AAEA,OAAO,SAASS,YAAY,GAAG;EAC7B,OAAO,CAACL,QAAQ,EAAEC,QAAQ,KAAK;IAC7BD,QAAQ,CAACH,QAAQ,EAAE,CAAC;IACpBG,QAAQ,CAACjB,cAAc,CAACkB,QAAQ,EAAE,CAACP,IAAI,CAACY,eAAe,CAAC,CAAC;IAEzD,MAAMV,OAAO,GAAGK,QAAQ,EAAE,CAACP,IAAI,CAACE,OAAO;IACvC,MAAMW,aAAa,GAAGN,QAAQ,EAAE,CAACO,OAAO,CAACC,IAAI,CAC1CC,MAAM,IAAKA,MAAM,CAACP,EAAE,KAAKF,QAAQ,EAAE,CAACP,IAAI,CAACY,eAAe,CAC1D;IAED,IAAIV,OAAO,GAAG,CAAC,CAAC,IAAIW,aAAa,CAACI,KAAK,IAAIf,OAAO,EAAE;MAClDI,QAAQ,CAACY,YAAY,CAAC9B,UAAU,CAAC+B,QAAQ,CAAC,CAAC;IAC7C;EACF,CAAC;AACH;AAEA,OAAO,SAASD,YAAY,CAACtB,SAAS,EAAE;EACtC,OAAO,CAACU,QAAQ,EAAEC,QAAQ,KAAK;IAC7BD,QAAQ,CAACX,QAAQ,CAACC,SAAS,CAAC,CAAC;IAE7B,IAAIA,SAAS,KAAKR,UAAU,CAACgC,UAAU,EAAE;MACvCd,QAAQ,CACNhB,aAAa,CACXJ,cAAc,CAACsB,WAAW,EAC1B,CAACD,QAAQ,EAAE,CAACP,IAAI,CAACS,EAAE,EAAE;QAAEZ,IAAI,EAAEV,eAAe,CAACI;MAAU,CAAC,EAAE,KAAK,CAAC,EAChE,YAAY,CAAC,CAAC,CACf,CACF;IACH;EACF,CAAC;AACH"},"metadata":{},"sourceType":"module"}