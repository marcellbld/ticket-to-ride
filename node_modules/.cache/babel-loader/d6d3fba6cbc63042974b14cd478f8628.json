{"ast":null,"code":"import * as actions from \"./actions\";\nimport io from \"socket.io-client\";\nlet socket = null;\nexport const socketMiddleware = () => next => action => {\n  switch (action.type) {\n    case \"WS_CONNECT\":\n      if (socket !== null) {\n        socket.close();\n      }\n      socket = io(action.host, {\n        transports: [\"websocket\", \"polling\", \"flashsocket\"]\n      });\n      break;\n    case actions.WS_SUBSCRIBE:\n      handleSubscribeToChannel(action.payload);\n      break;\n    case actions.WS_UNSUBSCRIBE:\n      handleUnsubscribeFromChannel(action.payload);\n      break;\n    case actions.WS_SEND_MESSAGE:\n      socket.emit(action.channel, ...action.datas, action.ack);\n      break;\n    case \"WS_DISCONNECT\":\n      if (socket !== null) {\n        socket.close();\n      }\n      socket = null;\n      console.log(\"websocket closed\");\n      break;\n    default:\n      return next(action);\n  }\n};\nexport function currentSocketId() {\n  return socket ? socket.id : null;\n}\nfunction handleSubscribeToChannel(_ref) {\n  let {\n    channel,\n    callback\n  } = _ref;\n  socket.on(channel, data => callback(data));\n}\nfunction handleUnsubscribeFromChannel(channel) {\n  socket.removeAllListeners(channel);\n}","map":{"version":3,"names":["actions","io","socket","socketMiddleware","next","action","type","close","host","transports","WS_SUBSCRIBE","handleSubscribeToChannel","payload","WS_UNSUBSCRIBE","handleUnsubscribeFromChannel","WS_SEND_MESSAGE","emit","channel","datas","ack","console","log","currentSocketId","id","callback","on","data","removeAllListeners"],"sources":["C:/Win11/Programming/Other/ticket-to-ride-app/src/state/socket/reducer.js"],"sourcesContent":["import * as actions from \"./actions\";\r\nimport io from \"socket.io-client\";\r\n\r\nlet socket = null;\r\n\r\nexport const socketMiddleware = () => (next) => (action) => {\r\n  switch (action.type) {\r\n    case \"WS_CONNECT\":\r\n      if (socket !== null) {\r\n        socket.close();\r\n      }\r\n\r\n      socket = io(action.host, {\r\n        transports: [\"websocket\", \"polling\", \"flashsocket\"],\r\n      });\r\n      break;\r\n    case actions.WS_SUBSCRIBE:\r\n      handleSubscribeToChannel(action.payload);\r\n      break;\r\n    case actions.WS_UNSUBSCRIBE:\r\n      handleUnsubscribeFromChannel(action.payload);\r\n      break;\r\n    case actions.WS_SEND_MESSAGE:\r\n      socket.emit(action.channel, ...action.datas, action.ack);\r\n      break;\r\n    case \"WS_DISCONNECT\":\r\n      if (socket !== null) {\r\n        socket.close();\r\n      }\r\n      socket = null;\r\n      console.log(\"websocket closed\");\r\n      break;\r\n    default:\r\n      return next(action);\r\n  }\r\n};\r\n\r\nexport function currentSocketId() {\r\n  return socket ? socket.id : null;\r\n}\r\n\r\nfunction handleSubscribeToChannel({ channel, callback }) {\r\n  socket.on(channel, (data) => callback(data));\r\n}\r\n\r\nfunction handleUnsubscribeFromChannel(channel) {\r\n  socket.removeAllListeners(channel);\r\n}\r\n"],"mappings":"AAAA,OAAO,KAAKA,OAAO,MAAM,WAAW;AACpC,OAAOC,EAAE,MAAM,kBAAkB;AAEjC,IAAIC,MAAM,GAAG,IAAI;AAEjB,OAAO,MAAMC,gBAAgB,GAAG,MAAOC,IAAI,IAAMC,MAAM,IAAK;EAC1D,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,YAAY;MACf,IAAIJ,MAAM,KAAK,IAAI,EAAE;QACnBA,MAAM,CAACK,KAAK,EAAE;MAChB;MAEAL,MAAM,GAAGD,EAAE,CAACI,MAAM,CAACG,IAAI,EAAE;QACvBC,UAAU,EAAE,CAAC,WAAW,EAAE,SAAS,EAAE,aAAa;MACpD,CAAC,CAAC;MACF;IACF,KAAKT,OAAO,CAACU,YAAY;MACvBC,wBAAwB,CAACN,MAAM,CAACO,OAAO,CAAC;MACxC;IACF,KAAKZ,OAAO,CAACa,cAAc;MACzBC,4BAA4B,CAACT,MAAM,CAACO,OAAO,CAAC;MAC5C;IACF,KAAKZ,OAAO,CAACe,eAAe;MAC1Bb,MAAM,CAACc,IAAI,CAACX,MAAM,CAACY,OAAO,EAAE,GAAGZ,MAAM,CAACa,KAAK,EAAEb,MAAM,CAACc,GAAG,CAAC;MACxD;IACF,KAAK,eAAe;MAClB,IAAIjB,MAAM,KAAK,IAAI,EAAE;QACnBA,MAAM,CAACK,KAAK,EAAE;MAChB;MACAL,MAAM,GAAG,IAAI;MACbkB,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;MAC/B;IACF;MACE,OAAOjB,IAAI,CAACC,MAAM,CAAC;EAAC;AAE1B,CAAC;AAED,OAAO,SAASiB,eAAe,GAAG;EAChC,OAAOpB,MAAM,GAAGA,MAAM,CAACqB,EAAE,GAAG,IAAI;AAClC;AAEA,SAASZ,wBAAwB,OAAwB;EAAA,IAAvB;IAAEM,OAAO;IAAEO;EAAS,CAAC;EACrDtB,MAAM,CAACuB,EAAE,CAACR,OAAO,EAAGS,IAAI,IAAKF,QAAQ,CAACE,IAAI,CAAC,CAAC;AAC9C;AAEA,SAASZ,4BAA4B,CAACG,OAAO,EAAE;EAC7Cf,MAAM,CAACyB,kBAAkB,CAACV,OAAO,CAAC;AACpC"},"metadata":{},"sourceType":"module"}