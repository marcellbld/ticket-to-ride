{"ast":null,"code":"import{ClientMessages,GameActionTypes}from\"../../api/socket\";import{GameStates}from\"../../domain/game\";import{nextPlayerTurn}from\"../players/actions\";import{wsSendMessage}from\"../socket/actions\";export var NEXT_TURN=\"NEXT_TURN\";export var SET_GAME=\"SET_GAME\";export var SET_GAME_STATE=\"SET_GAME_STATE\";export var SET_END_TURN=\"SET_END_TURN\";function setState(gameState){return{type:SET_GAME_STATE,payload:gameState};}export function setGame(game){return{type:SET_GAME,payload:game};}function setEndGameTurn(endTurn){return{type:SET_END_TURN,payload:endTurn};}function nextTurn(){return{type:\"NEXT_TURN\"};}export function setEndTurn(endTurn){var broadcast=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return function(dispatch,getState){dispatch(setEndGameTurn(endTurn));if(broadcast){dispatch(wsSendMessage(ClientMessages.SYNC_ACTION,[getState().game.id,{type:GameActionTypes.END_TURN,payload:endTurn},false],function(){}));}};}export function nextGameTurn(){return function(dispatch,getState){dispatch(nextTurn());dispatch(nextPlayerTurn(getState().game.currentPlayerId));var endTurn=getState().game.endTurn;var currentPlayer=getState().players.find(function(player){return player.id===getState().game.currentPlayerId;});if(endTurn>-1&&currentPlayer.round>=endTurn){dispatch(setGameState(GameStates.END_GAME));}};}export function setGameState(gameState){return function(dispatch,getState){dispatch(setState(gameState));if(gameState===GameStates.DRAW_CARD2){dispatch(wsSendMessage(ClientMessages.SYNC_ACTION,[getState().game.id,{type:GameActionTypes.NEXT_TURN},false],function(){}));}};}","map":{"version":3,"names":["ClientMessages","GameActionTypes","GameStates","nextPlayerTurn","wsSendMessage","NEXT_TURN","SET_GAME","SET_GAME_STATE","SET_END_TURN","setState","gameState","type","payload","setGame","game","setEndGameTurn","endTurn","nextTurn","setEndTurn","broadcast","dispatch","getState","SYNC_ACTION","id","END_TURN","nextGameTurn","currentPlayerId","currentPlayer","players","find","player","round","setGameState","END_GAME","DRAW_CARD2"],"sources":["C:/Win11/Programming/Other/ticket-to-ride-app/src/state/game/actions.js"],"sourcesContent":["import { ClientMessages, GameActionTypes } from \"../../api/socket\";\r\nimport { GameStates } from \"../../domain/game\";\r\nimport { nextPlayerTurn } from \"../players/actions\";\r\nimport { wsSendMessage } from \"../socket/actions\";\r\n\r\nexport const NEXT_TURN = \"NEXT_TURN\";\r\nexport const SET_GAME = \"SET_GAME\";\r\nexport const SET_GAME_STATE = \"SET_GAME_STATE\";\r\nexport const SET_END_TURN = \"SET_END_TURN\";\r\n\r\nfunction setState(gameState) {\r\n  return {\r\n    type: SET_GAME_STATE,\r\n    payload: gameState,\r\n  };\r\n}\r\n\r\nexport function setGame(game) {\r\n  return {\r\n    type: SET_GAME,\r\n    payload: game,\r\n  };\r\n}\r\n\r\nfunction setEndGameTurn(endTurn) {\r\n  return {\r\n    type: SET_END_TURN,\r\n    payload: endTurn,\r\n  };\r\n}\r\n\r\nfunction nextTurn() {\r\n  return {\r\n    type: \"NEXT_TURN\",\r\n  };\r\n}\r\n\r\nexport function setEndTurn(endTurn, broadcast = false) {\r\n  return (dispatch, getState) => {\r\n    dispatch(setEndGameTurn(endTurn));\r\n    if (broadcast) {\r\n      dispatch(\r\n        wsSendMessage(\r\n          ClientMessages.SYNC_ACTION,\r\n          [\r\n            getState().game.id,\r\n            { type: GameActionTypes.END_TURN, payload: endTurn },\r\n            false,\r\n          ],\r\n          function () {}\r\n        )\r\n      );\r\n    }\r\n  };\r\n}\r\n\r\nexport function nextGameTurn() {\r\n  return (dispatch, getState) => {\r\n    dispatch(nextTurn());\r\n    dispatch(nextPlayerTurn(getState().game.currentPlayerId));\r\n\r\n    const endTurn = getState().game.endTurn;\r\n    const currentPlayer = getState().players.find(\r\n      (player) => player.id === getState().game.currentPlayerId\r\n    );\r\n\r\n    if (endTurn > -1 && currentPlayer.round >= endTurn) {\r\n      dispatch(setGameState(GameStates.END_GAME));\r\n    }\r\n  };\r\n}\r\n\r\nexport function setGameState(gameState) {\r\n  return (dispatch, getState) => {\r\n    dispatch(setState(gameState));\r\n\r\n    if (gameState === GameStates.DRAW_CARD2) {\r\n      dispatch(\r\n        wsSendMessage(\r\n          ClientMessages.SYNC_ACTION,\r\n          [getState().game.id, { type: GameActionTypes.NEXT_TURN }, false],\r\n          function () {}\r\n        )\r\n      );\r\n    }\r\n  };\r\n}\r\n"],"mappings":"AAAA,OAASA,cAAc,CAAEC,eAAe,KAAQ,kBAAkB,CAClE,OAASC,UAAU,KAAQ,mBAAmB,CAC9C,OAASC,cAAc,KAAQ,oBAAoB,CACnD,OAASC,aAAa,KAAQ,mBAAmB,CAEjD,MAAO,IAAMC,UAAS,CAAG,WAAW,CACpC,MAAO,IAAMC,SAAQ,CAAG,UAAU,CAClC,MAAO,IAAMC,eAAc,CAAG,gBAAgB,CAC9C,MAAO,IAAMC,aAAY,CAAG,cAAc,CAE1C,QAASC,SAAQ,CAACC,SAAS,CAAE,CAC3B,MAAO,CACLC,IAAI,CAAEJ,cAAc,CACpBK,OAAO,CAAEF,SACX,CAAC,CACH,CAEA,MAAO,SAASG,QAAO,CAACC,IAAI,CAAE,CAC5B,MAAO,CACLH,IAAI,CAAEL,QAAQ,CACdM,OAAO,CAAEE,IACX,CAAC,CACH,CAEA,QAASC,eAAc,CAACC,OAAO,CAAE,CAC/B,MAAO,CACLL,IAAI,CAAEH,YAAY,CAClBI,OAAO,CAAEI,OACX,CAAC,CACH,CAEA,QAASC,SAAQ,EAAG,CAClB,MAAO,CACLN,IAAI,CAAE,WACR,CAAC,CACH,CAEA,MAAO,SAASO,WAAU,CAACF,OAAO,CAAqB,IAAnBG,UAAS,2DAAG,KAAK,CACnD,MAAO,UAACC,QAAQ,CAAEC,QAAQ,CAAK,CAC7BD,QAAQ,CAACL,cAAc,CAACC,OAAO,CAAC,CAAC,CACjC,GAAIG,SAAS,CAAE,CACbC,QAAQ,CACNhB,aAAa,CACXJ,cAAc,CAACsB,WAAW,CAC1B,CACED,QAAQ,EAAE,CAACP,IAAI,CAACS,EAAE,CAClB,CAAEZ,IAAI,CAAEV,eAAe,CAACuB,QAAQ,CAAEZ,OAAO,CAAEI,OAAQ,CAAC,CACpD,KAAK,CACN,CACD,UAAY,CAAC,CAAC,CACf,CACF,CACH,CACF,CAAC,CACH,CAEA,MAAO,SAASS,aAAY,EAAG,CAC7B,MAAO,UAACL,QAAQ,CAAEC,QAAQ,CAAK,CAC7BD,QAAQ,CAACH,QAAQ,EAAE,CAAC,CACpBG,QAAQ,CAACjB,cAAc,CAACkB,QAAQ,EAAE,CAACP,IAAI,CAACY,eAAe,CAAC,CAAC,CAEzD,GAAMV,QAAO,CAAGK,QAAQ,EAAE,CAACP,IAAI,CAACE,OAAO,CACvC,GAAMW,cAAa,CAAGN,QAAQ,EAAE,CAACO,OAAO,CAACC,IAAI,CAC3C,SAACC,MAAM,QAAKA,OAAM,CAACP,EAAE,GAAKF,QAAQ,EAAE,CAACP,IAAI,CAACY,eAAe,GAC1D,CAED,GAAIV,OAAO,CAAG,CAAC,CAAC,EAAIW,aAAa,CAACI,KAAK,EAAIf,OAAO,CAAE,CAClDI,QAAQ,CAACY,YAAY,CAAC9B,UAAU,CAAC+B,QAAQ,CAAC,CAAC,CAC7C,CACF,CAAC,CACH,CAEA,MAAO,SAASD,aAAY,CAACtB,SAAS,CAAE,CACtC,MAAO,UAACU,QAAQ,CAAEC,QAAQ,CAAK,CAC7BD,QAAQ,CAACX,QAAQ,CAACC,SAAS,CAAC,CAAC,CAE7B,GAAIA,SAAS,GAAKR,UAAU,CAACgC,UAAU,CAAE,CACvCd,QAAQ,CACNhB,aAAa,CACXJ,cAAc,CAACsB,WAAW,CAC1B,CAACD,QAAQ,EAAE,CAACP,IAAI,CAACS,EAAE,CAAE,CAAEZ,IAAI,CAAEV,eAAe,CAACI,SAAU,CAAC,CAAE,KAAK,CAAC,CAChE,UAAY,CAAC,CAAC,CACf,CACF,CACH,CACF,CAAC,CACH"},"metadata":{},"sourceType":"module"}